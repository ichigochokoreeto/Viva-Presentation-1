/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Main.java to edit this template
 */
package q3securitycheck;

import java.util.Scanner;
/**
 *
 * @author ASUS
 */
public class Q3SecurityCheck {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // TODO code application logic here
        Scanner sc = new Scanner(System.in);

        // Input username
        System.out.print("Enter username: ");
        String username = sc.nextLine();

        // Validate username
        if (!isValidUsername(username)) {
            System.out.println("Invalid username");
            return;
        }

        // Username valid â†’ proceed to password
        System.out.print("Enter password: ");
        String password = sc.nextLine();

        int rulesMet = countPasswordRules(username, password);

        // Determine password strength
        String strength;
        if (rulesMet <= 3) strength = "Weak";
        else if (rulesMet <= 5) strength = "Moderate";
        else if (rulesMet == 6) strength = "Strong";
        else strength = "Very Strong";

        System.out.println("Password Strength: " + strength);
    }
    
     /// Username validator
    public static boolean isValidUsername(String username) {

        // Length rule
        if (username.length() < 5 || username.length() > 15)
            return false;

        // Must start with a letter
        if (!Character.isLetter(username.charAt(0)))
            return false;

        // Validate each character
        for (int i = 0; i < username.length(); i++) {
            char c = username.charAt(i);

            // Only lowercase letters, digits, or underscore
            if (!(Character.isLowerCase(c) || Character.isDigit(c) || c == '_'))
                return false;

            // Uppercase not allowed
            if (Character.isUpperCase(c))
                return false;
        }

        return true;
    }

    // //Password rules checker
    public static int countPasswordRules(String username, String password) {
        int count = 0;

        boolean hasUpper = false, hasLower = false, hasDigit = false;
        boolean hasSpecial = false;

        // Rule 1: Minimum 8 characters
        if (password.length() >= 8) count++;

        // Rule 6: Must not contain spaces
        if (!password.contains(" ")) count++;

        // Rule 7: Must NOT contain username (case-insensitive)
        if (!password.toLowerCase().contains(username.toLowerCase())) count++;

        // Check other character rules
        for (int i = 0; i < password.length(); i++) {
            char c = password.charAt(i);

            if (Character.isUpperCase(c)) hasUpper = true;
            if (Character.isLowerCase(c)) hasLower = true;
            if (Character.isDigit(c)) hasDigit = true;

            if ("!@#$%^&*".indexOf(c) != -1)
                hasSpecial = true;
        }

        if (hasUpper) count++;
        if (hasLower) count++;
        if (hasDigit) count++;
        if (hasSpecial) count++;
        return count;
    }
}
