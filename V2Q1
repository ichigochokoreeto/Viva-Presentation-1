package v2q1;

import java.util.Scanner;

public class V2Q1 {
    
    public static boolean isAnagram(String a, String b){
        a = a.toLowerCase().trim();
        b = b.toLowerCase().trim();
        
        //Tukar a & b jadi array char
        int[] count = new int[26]; //26 huruf (a-z)
        
        for(char c : a.toCharArray()){
            if(c >= 'a' && c <= 'z') count[c - 'a']++; //Tambah count untuk setiap huruf kat a
        } //Contoh: "banana" -> b=1, a=3, n=2
        for(char c : b.toCharArray()){ //Tolak count untuk setiap huruf kat b
            if(c >= 'a' && c <= 'z') count[c - 'a']--; //Contoh: "ban" -> b=-1, a=-1, n=-1
        }//Baki count -> a=2, b=0, n=1
        
        //Check total balance
        int nonZero = 0; //nonZero ialah jumlah baki semua huruf, kalau o, confirm anagram macam listen <-> silent
        for(int c : count){
            if(c != 0) nonZero += Math.abs(c);
        }

        //Kalau balance 0 atau lebih besar, tapi ada huruf yang sama, kita anggap ada match
        //Untuk kes "banana" & "ban", semua huruf "b a n" ada di "banana" â†’ return true
        if(a.length() == b.length()) return nonZero == 0;

        //Check subset untuk perkataan lebih pendek
        boolean subset = true;
        for(int i = 0; i < 26; i++){ 
            if(count[i] < 0) subset = false; //Kalau perkataan b pendek, semua huruf dia ada dalam a
        } //Kalau ada count[i]<0 -> b ada huruf lebih dari a, bukan subset, return false
    return subset; //Kalau semua ok -> return true
    }

    
    //Count characters in a word
    public static int countChar(String str){
        return str.length();
    }
    
    //Remove duplicates and return new size
    public static int removeDuplicates(String[] words, int n){
        int size = 0;
        for(int i = 0; i < n; i++){
            boolean duplicate = false;
            for(int j = 0; j < size; j++){
                if(words[i].equalsIgnoreCase(words[j])){ //huruf besar/kecil sama je
                    duplicate = true;
                    break;
                }
            }
            if(!duplicate) words[size++] = words[i]; //Kalau tak duplicate, accept perkataan tu 
        }
        return size;
    }

    public static void main(String[] args){
        
        Scanner input = new Scanner(System.in);
        
        System.out.print("Enter the number of words: ");
        int n = input.nextInt();
        input.nextLine(); //clear newline
        
        //Enter words
        String[] words = new String[n];
        for(int i=0; i<n; i++){
            System.out.print("Enter a word: ");
            words[i] = input.nextLine().trim(); //nextLine() baca satu sentence, trim() remove space kat depan & belakang
        }
        
        //Remove duplicates
        n = removeDuplicates(words, n);
    
        boolean[] grouped = new boolean[n]; // track grouped words
        int groupNum = 1;

        // Find anagram groups
        for(int i = 0; i < n; i++){
            if(!grouped[i]){ //kalau perkataan tu belum digunakan, cari anagram dia
                String group = words[i];
                boolean hasAnagram = false;
                for (int j = i + 1; j < n; j++) {
                    if (!grouped[j] && isAnagram(words[i], words[j])) {
                        group += " " + words[j];
                        grouped[j] = true;
                        hasAnagram = true;
                    }
                }
                if(hasAnagram){ //Print anagram
                    System.out.println("Anagram group " + groupNum + ": " + group);
                    grouped[i] = true;
                    groupNum++;
                }
            }
        }

        //Print words without group
        String noGroup = "";
        for (int i = 0; i < n; i++){
            if(!grouped[i]) noGroup += words[i] + " ";
        }
        if (!noGroup.isEmpty()){
            System.out.println("Without anagram group: " + noGroup.trim()); //reim) remove extra space kat hujung
        }
    }        
}
